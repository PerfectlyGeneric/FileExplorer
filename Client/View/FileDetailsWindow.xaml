<Window x:Class="AplicationUI.View.FileDetailsWindow" 
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:vm="clr-namespace:FileExplorer.ViewModel"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="{Binding File.Name, StringFormat='Editing {0}'}" 
        Height="550" Width="700"
        WindowStartupLocation="CenterOwner" 
        ShowInTaskbar="True" 
        WindowStyle="ToolWindow"
        ResizeMode="NoResize"
        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">

    <Window.Resources>
        <BitmapImage x:Key="LeftArrowIcon" UriSource="/Resources/left_arrow.png" />
        <BitmapImage x:Key="RightArrowIcon" UriSource="/Resources/right_arrow.png" />

        <DataTemplate DataType="{x:Type vm:DefaultPreview}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <Border BorderBrush="LightGray" BorderThickness="1" CornerRadius="5" Width="120" Height="120" Background="White" Margin="0,0,0,10">
                    <Image Source="{Binding FileData.Icon}" Width="64" Height="64" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
                <TextBlock Text="{Binding FileData.Name}" FontWeight="Bold" TextAlignment="Center" TextWrapping="Wrap" Margin="0,5,0,0"/>
                <TextBlock Text="{Binding Path}" FontSize="10" Foreground="Gray" TextAlignment="Center" TextWrapping="Wrap" Margin="0,3,0,0"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type vm:ImagePreview}">
            <Grid>
                <Image Source="{Binding Path}" 
                   Stretch="Uniform" 
                   HorizontalAlignment="Center" 
                   VerticalAlignment="Center"/>
            </Grid>
        </DataTemplate>



        <DataTemplate x:Key="TagItemTemplate">
            <Button Command="{Binding DataContext.RemoveTagCommand, RelativeSource={RelativeSource AncestorType=Window}}" 
                    CommandParameter="{Binding}"
                    Cursor="Hand"
                    Margin="0,0,5,5"
                    BorderThickness="0"
                    Background="Transparent">
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <Border Background="#666666" 
                                CornerRadius="12" 
                                Padding="10,5">
                            <TextBlock Text="{Binding}" 
                                       Foreground="White" 
                                       FontSize="12" 
                                       FontWeight="SemiBold"/>
                        </Border>
                    </ControlTemplate>
                </Button.Template>
            </Button>
        </DataTemplate>

        <DataTemplate x:Key="SuggestedTagItemTemplate">
            <Button Command="{Binding DataContext.AddSuggestedTagCommand, RelativeSource={RelativeSource AncestorType=Window}}" 
                    CommandParameter="{Binding}"
                    Cursor="Hand"
                    Margin="0,0,5,5"
                    BorderThickness="0"
                    Background="Transparent">
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <Border Background="#999999" 
                                CornerRadius="12" 
                                Padding="10,5">
                            <TextBlock Text="{Binding}" 
                                       Foreground="White" 
                                       FontSize="12" 
                                       FontWeight="SemiBold"/>
                        </Border>
                    </ControlTemplate>
                </Button.Template>
            </Button>
        </DataTemplate>
    </Window.Resources>

    <Grid Margin="15">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Grid Grid.Column="0" Margin="0,0,15,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <ContentControl Grid.Row="0" Content="{Binding CurrentPreview}">
               
            </ContentControl>

            <Grid Grid.Row="1" Margin="0,20,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Button Grid.Column="0" Width="40" Height="30" ToolTip="Previous" Background="Gray">
                    <Image Source="{StaticResource LeftArrowIcon}" Width="16"/>
                </Button>
                <Button Grid.Column="1" Content="Sequence" Foreground="White" Background="Gray" Margin="10,0" Height="30"/>
                <Button Grid.Column="2" Width="40" Height="30" ToolTip="Next" Background="Gray">
                    <Image Source="{StaticResource RightArrowIcon}" Width="16"/>
                </Button>
            </Grid>
        </Grid>

        <StackPanel Grid.Column="1" VerticalAlignment="Stretch">

            <TextBlock Text="Your Tags" FontWeight="SemiBold" Margin="0,0,0,5"/>

            <Border BorderBrush="#ABADB3" BorderThickness="1" CornerRadius="5" Background="White" 
                    Margin="0,0,0,15" Height="80">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <ItemsControl ItemsSource="{Binding YourTags}" 
                                  ItemTemplate="{StaticResource TagItemTemplate}"
                                  Padding="5,5,0,0">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                    </ItemsControl>
                </ScrollViewer>
            </Border>

            <TextBlock Text="AI Suggested Tags" FontWeight="SemiBold" Margin="0,0,0,5"/>

            <Border BorderBrush="#ABADB3" BorderThickness="1" CornerRadius="5" Background="#F0F0F0" 
                    Margin="0,0,0,15" Height="80">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <ItemsControl ItemsSource="{Binding SuggestedTags}" 
                                  ItemTemplate="{StaticResource SuggestedTagItemTemplate}"
                                  Padding="5,5,0,0">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                    </ItemsControl>
                </ScrollViewer>
            </Border>

            <TextBlock Text="Notes" FontWeight="SemiBold" Margin="0,0,0,5"/>
            <TextBox Text="{Binding Notes, UpdateSourceTrigger=PropertyChanged}"
                     AcceptsReturn="True" 
                     VerticalScrollBarVisibility="Auto" 
                     TextWrapping="Wrap"
                     Height="120"
                     Margin="0,0,0,15"/>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Save" Width="80" Margin="0,0,10,0"
                        Command="{Binding SaveCommand}"
                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"/>
                <Button Content="Close" Width="80" Command="{Binding CloseCommand}" IsCancel="True"/>
            </StackPanel>
        </StackPanel>
    </Grid>
</Window>